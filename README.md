# shopping
CREATE TABLE CART 
(
  CART_NO NUMBER NOT NULL 
, PROD_NO NUMBER NOT NULL 
, CUS_NO NUMBER NOT NULL 
, PUR_DT DATE DEFAULT NULL 
, PUR_QTY NUMBER 
) 
LOGGING 
TABLESPACE SYSTEM 
PCTFREE 10 
PCTUSED 40 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  FREELISTS 1 
  FREELIST GROUPS 1 
  BUFFER_POOL DEFAULT 
) 
NOPARALLEL;

CREATE UNIQUE INDEX XPK_CART ON CART (CART_NO ASC, PROD_NO ASC) 
LOGGING 
TABLESPACE SYSTEM 
PCTFREE 10 
INITRANS 2 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  FREELISTS 1 
  FREELIST GROUPS 1 
  BUFFER_POOL DEFAULT 
) 
NOPARALLEL;

ALTER TABLE CART
ADD CONSTRAINT XPK_CART PRIMARY KEY 
(
  CART_NO 
, PROD_NO 
)
USING INDEX SHOPPING.XPK_CART
ENABLE;

ALTER TABLE CART
ADD CONSTRAINT R_4 FOREIGN KEY
(
  CUS_NO 
)
REFERENCES CUSTOMER
(
  CUS_NO 
)
ON DELETE CASCADE ENABLE;

ALTER TABLE CART
ADD CONSTRAINT R_8 FOREIGN KEY
(
  PROD_NO 
)
REFERENCES PROD
(
  PROD_NO 
)
ON DELETE CASCADE ENABLE;

CREATE TABLE CUSTOMER 
(
  CUS_NO NUMBER NOT NULL 
, CUS_NM VARCHAR2(50 BYTE) NOT NULL 
, CUS_ID VARCHAR2(30 BYTE) NOT NULL 
, CUS_PW VARCHAR2(50 BYTE) NOT NULL 
, CUS_MAIL VARCHAR2(50 BYTE) NOT NULL 
, CUS_ADDR VARCHAR2(300 BYTE) NOT NULL 
, CUS_PH VARCHAR2(20 BYTE) NOT NULL 
) 
LOGGING 
TABLESPACE SYSTEM 
PCTFREE 10 
PCTUSED 40 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  FREELISTS 1 
  FREELIST GROUPS 1 
  BUFFER_POOL DEFAULT 
) 
NOPARALLEL;

CREATE UNIQUE INDEX XPK_CUSTOMER ON CUSTOMER (CUS_NO ASC) 
LOGGING 
TABLESPACE SYSTEM 
PCTFREE 10 
INITRANS 2 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  FREELISTS 1 
  FREELIST GROUPS 1 
  BUFFER_POOL DEFAULT 
) 
NOPARALLEL;

ALTER TABLE CUSTOMER
ADD CONSTRAINT XPK_CUSTOMER PRIMARY KEY 
(
  CUS_NO 
)
USING INDEX SHOPPING.XPK_CUSTOMER
ENABLE;

CREATE TABLE MAN 
(
  MAN_NO NUMBER NOT NULL 
, MAN_NM VARCHAR2(50 BYTE) NOT NULL 
, MAN_ID VARCHAR2(30 BYTE) NOT NULL 
, MAN_PW VARCHAR2(30 BYTE) NOT NULL 
) 
LOGGING 
TABLESPACE SYSTEM 
PCTFREE 10 
PCTUSED 40 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  FREELISTS 1 
  FREELIST GROUPS 1 
  BUFFER_POOL DEFAULT 
) 
NOPARALLEL;

CREATE UNIQUE INDEX XPK_MAN ON MAN (MAN_NO ASC) 
LOGGING 
TABLESPACE SYSTEM 
PCTFREE 10 
INITRANS 2 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  FREELISTS 1 
  FREELIST GROUPS 1 
  BUFFER_POOL DEFAULT 
) 
NOPARALLEL;

ALTER TABLE MAN
ADD CONSTRAINT XPK_MAN PRIMARY KEY 
(
  MAN_NO 
)
USING INDEX SHOPPING.XPK_MAN
ENABLE;

CREATE TABLE NOTICE 
(
  NOTI_NO NUMBER NOT NULL 
, NOTI_CONT VARCHAR2(1000 BYTE) 
, NOTI_DATE DATE DEFAULT SYSDATE 
, MAN_NO NUMBER 
, NOTI_TITLE VARCHAR2(1000 BYTE) 
) 
LOGGING 
TABLESPACE SYSTEM 
PCTFREE 10 
PCTUSED 40 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  FREELISTS 1 
  FREELIST GROUPS 1 
  BUFFER_POOL DEFAULT 
) 
NOPARALLEL;

CREATE UNIQUE INDEX XPK_NOTICE ON NOTICE (NOTI_NO ASC) 
LOGGING 
TABLESPACE SYSTEM 
PCTFREE 10 
INITRANS 2 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  FREELISTS 1 
  FREELIST GROUPS 1 
  BUFFER_POOL DEFAULT 
) 
NOPARALLEL;

ALTER TABLE NOTICE
ADD CONSTRAINT XPK_NOTICE PRIMARY KEY 
(
  NOTI_NO 
)
USING INDEX SHOPPING.XPK_NOTICE
ENABLE;

CREATE TABLE PROD 
(
  PROD_NO NUMBER NOT NULL 
, PROD_SIZE VARCHAR2(20 BYTE) NOT NULL 
, PROD_COL VARCHAR2(20 BYTE) NOT NULL 
, PROD_NM VARCHAR2(60 BYTE) NOT NULL 
, PROD_PRI VARCHAR2(50 BYTE) NOT NULL 
, PROD_QTY NUMBER NOT NULL 
, MAN_NO NUMBER DEFAULT 1 
) 
LOGGING 
TABLESPACE SYSTEM 
PCTFREE 10 
PCTUSED 40 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  FREELISTS 1 
  FREELIST GROUPS 1 
  BUFFER_POOL DEFAULT 
) 
NOPARALLEL;

CREATE UNIQUE INDEX XPK_PROD ON PROD (PROD_NO ASC) 
LOGGING 
TABLESPACE SYSTEM 
PCTFREE 10 
INITRANS 2 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  FREELISTS 1 
  FREELIST GROUPS 1 
  BUFFER_POOL DEFAULT 
) 
NOPARALLEL;

ALTER TABLE PROD
ADD CONSTRAINT XPK_PROD PRIMARY KEY 
(
  PROD_NO 
)
USING INDEX SHOPPING.XPK_PROD
ENABLE;

ALTER TABLE PROD
ADD CONSTRAINT R_6 FOREIGN KEY
(
  MAN_NO 
)
REFERENCES MAN
(
  MAN_NO 
)
ON DELETE CASCADE ENABLE;

CREATE TABLE REVIEW 
(
  REV_NO NUMBER NOT NULL 
, REV_CONT VARCHAR2(2000 BYTE) 
, REV_DT DATE DEFAULT SYSDATE 
, CUS_NO NUMBER 
, CART_NO NUMBER 
, PROD_NO NUMBER 
, REV_TITLE VARCHAR2(60 BYTE) 
) 
LOGGING 
TABLESPACE SYSTEM 
PCTFREE 10 
PCTUSED 40 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  FREELISTS 1 
  FREELIST GROUPS 1 
  BUFFER_POOL DEFAULT 
) 
NOPARALLEL;

CREATE UNIQUE INDEX XPK_REVIEW ON REVIEW (REV_NO ASC) 
LOGGING 
TABLESPACE SYSTEM 
PCTFREE 10 
INITRANS 2 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  FREELISTS 1 
  FREELIST GROUPS 1 
  BUFFER_POOL DEFAULT 
) 
NOPARALLEL;

ALTER TABLE REVIEW
ADD CONSTRAINT XPK_REVIEW PRIMARY KEY 
(
  REV_NO 
)
USING INDEX SHOPPING.XPK_REVIEW
ENABLE;

ALTER TABLE REVIEW
ADD CONSTRAINT REVIEW_FK1 FOREIGN KEY
(
  CUS_NO 
)
REFERENCES CUSTOMER
(
  CUS_NO 
)
ON DELETE CASCADE ENABLE;

ALTER TABLE REVIEW
ADD CONSTRAINT REVIEW_FK2 FOREIGN KEY
(
  PROD_NO 
)
REFERENCES PROD
(
  PROD_NO 
)
ON DELETE CASCADE ENABLE;

ALTER TABLE REVIEW
ADD CONSTRAINT REVIEW_FK3 FOREIGN KEY
(
  CART_NO 
, PROD_NO 
)
REFERENCES CART
(
  CART_NO 
, PROD_NO 
)
ON DELETE CASCADE ENABLE;
